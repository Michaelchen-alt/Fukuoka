<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>九州・福岡小旅行 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #001e43; /* 博多織深藍 */
            --accent: #e57373;  /* 櫻花粉紅/明太子色 */
            --bg: #fdfdfd;
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: #2d3748;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .bottom-nav-item.active { color: var(--accent); }
        .day-tab.active, .guide-day-tab.active { 
            background-color: var(--primary) !important; 
            color: white !important;
            border-radius: 12px;
        }
        .custom-shadow { box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        input, textarea, select { font-size: 16px !important; }
        .glass-morphism {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-size: 11px;
            padding: 6px 10px;
            border-radius: 10px;
            font-weight: 700;
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
        }
        .map-btn { background-color: #f1f5f9; color: var(--primary); }
        .search-btn { background-color: #fff1f2; color: #e11d48; }
        .action-btn:active { transform: scale(0.95); opacity: 0.8; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        table { border-collapse: separate; border-spacing: 0; }
        .order-btn {
            padding: 4px 6px; font-size: 12px; border-radius: 6px;
            background-color: #f8fafc; color: #64748b; border: 1px solid #e2e8f0;
        }
        .tip-card { border-left: 5px solid var(--primary); transition: transform 0.2s; }
    </style>
</head>
<body class="pb-28">

    <!-- Header -->
    <header class="bg-[#001e43] text-white p-5 sticky top-0 z-40 shadow-xl">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="text-xl font-black tracking-tighter">九州・福岡 2026</h1>
                <p class="text-[10px] opacity-70 uppercase tracking-widest font-bold">Family Travel Planner</p>
            </div>
            <div class="text-right">
                <div class="bg-amber-400 text-[#001e43] px-2 py-0.5 rounded-md font-black text-[10px]">CI116/CI117</div>
            </div>
        </div>
    </header>

    <main class="w-full md:max-w-screen-md mx-auto">

        <!-- PLAN (行程表) -->
        <section id="plan" class="tab-content active animate-in fade-in duration-500">
            <div class="bg-slate-900 p-5 mb-1 shadow-lg text-white relative overflow-hidden">
                <div class="absolute -top-10 -right-10 w-32 h-32 bg-indigo-500/20 rounded-full blur-3xl"></div>
                <h3 class="text-xs font-black text-amber-400 mb-4 uppercase tracking-widest flex items-center gap-2"><i class="fas fa-plane"></i> 航班資訊</h3>
                <div class="grid grid-cols-1 gap-3 text-xs">
                    <div class="bg-white/5 p-4 rounded-2xl border border-white/10">
                        <span class="bg-indigo-500 px-2 py-0.5 rounded font-bold uppercase">去程 2/08 (日)</span>
                        <p class="mt-2 font-bold"><span class="text-amber-400">CI116</span> 16:25 TPE T2 → 19:35 FUK I (A330-300)</p>
                    </div>
                    <div class="bg-white/5 p-4 rounded-2xl border border-white/10">
                        <span class="bg-rose-500 px-2 py-0.5 rounded font-bold uppercase">回程 2/14 (六)</span>
                        <p class="mt-2 font-bold"><span class="text-amber-400">CI117</span> 20:35 FUK I → 22:20 TPE T2 (A321NEO)</p>
                    </div>
                </div>
            </div>
            <div class="bg-white p-5 mb-4 shadow-sm border-b border-slate-100">
                <h3 class="text-xs font-black text-slate-400 mb-4 uppercase tracking-widest flex items-center gap-2"><i class="fas fa-bed"></i> 住宿安排</h3>
                <div class="space-y-4 text-sm font-bold">
                    <div class="flex justify-between items-center"><span>2/08 博多西中州東橫INN</span><button onclick="openMap('博多西中州東橫INN')" class="action-btn map-btn">Map</button></div>
                    <div class="flex justify-between items-center border-t pt-4"><span>2/09 别府龜之井酒店</span><button onclick="openMap('别府龜之井酒店')" class="action-btn map-btn">Map</button></div>
                    <div class="flex justify-between items-center border-t pt-4"><div>2/10 小倉站南東橫INN<p class="text-rose-500 text-[10px]">停車 500円/晚</p></div><button onclick="openMap('小倉站南東橫INN')" class="action-btn map-btn">Map</button></div>
                    <div class="flex justify-between items-center border-t pt-4"><span>2/11-14 博多大和魯內飯店</span><button onclick="openMap('博多大和魯內飯店')" class="action-btn map-btn">Map</button></div>
                </div>
            </div>
            <div class="flex min-h-[500px]">
                <div class="w-16 flex-shrink-0 bg-slate-50 flex flex-col border-r border-slate-100">
                    <button onclick="switchDay(1)" id="day-btn-1" class="day-tab flex-1 py-4 text-xs font-black">D1</button>
                    <button onclick="switchDay(2)" id="day-btn-2" class="day-tab flex-1 py-4 text-xs font-black">D2</button>
                    <button onclick="switchDay(3)" id="day-btn-3" class="day-tab flex-1 py-4 text-xs font-black">D3</button>
                    <button onclick="switchDay(4)" id="day-btn-4" class="day-tab flex-1 py-4 text-xs font-black">D4</button>
                    <button onclick="switchDay(5)" id="day-btn-5" class="day-tab flex-1 py-4 text-xs font-black">D5</button>
                    <button onclick="switchDay(6)" id="day-btn-6" class="day-tab flex-1 py-4 text-xs font-black">D6</button>
                    <button onclick="switchDay(7)" id="day-btn-7" class="day-tab flex-1 py-4 text-xs font-black">D7</button>
                </div>
                <div id="day-content" class="flex-1 bg-white p-4 overflow-y-auto no-scrollbar"></div>
            </div>
        </section>

        <!-- GUIDE (深度導覽) -->
        <section id="guide" class="tab-content animate-in slide-in-from-right duration-500">
            <div class="flex min-h-[500px]">
                <div class="w-16 flex-shrink-0 bg-indigo-50 flex flex-col border-r border-indigo-100">
                    <button onclick="switchGuideDay(1)" id="guide-day-btn-1" class="guide-day-tab flex-1 py-4 text-xs font-black">D1</button>
                    <button onclick="switchGuideDay(2)" id="guide-day-btn-2" class="guide-day-tab flex-1 py-4 text-xs font-black">D2</button>
                    <button onclick="switchGuideDay(3)" id="guide-day-btn-3" class="guide-day-tab flex-1 py-4 text-xs font-black">D3</button>
                    <button onclick="switchGuideDay(4)" id="guide-day-btn-4" class="guide-day-tab flex-1 py-4 text-xs font-black">D4</button>
                    <button onclick="switchGuideDay(5)" id="guide-day-btn-5" class="guide-day-tab flex-1 py-4 text-xs font-black">D5</button>
                    <button onclick="switchGuideDay(6)" id="guide-day-btn-6" class="guide-day-tab flex-1 py-4 text-xs font-black">D6</button>
                    <button onclick="switchGuideDay(7)" id="guide-day-btn-7" class="guide-day-tab flex-1 py-4 text-xs font-black">D7</button>
                </div>
                <div id="guide-content" class="flex-1 bg-white p-5 overflow-y-auto no-scrollbar"></div>
            </div>
        </section>

        <!-- WALLET (記帳) -->
        <section id="wallet" class="tab-content animate-in p-0">
            <div class="bg-slate-900 p-6 text-white shadow-xl relative overflow-hidden">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-[10px] font-bold opacity-60 uppercase tracking-widest">台銀賣出即期匯率 (JPY)</span>
                    <a href="https://rate.bot.com.tw/xrt?Lang=zh-tw&redirect=true" target="_blank" class="bg-indigo-600 text-[10px] px-3 py-1 rounded-full border border-indigo-400 text-center">台銀官網</a>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-xs font-bold opacity-50">1 JPY =</span>
                    <input id="rate-input" type="number" step="0.0001" value="0.2059" class="bg-white/10 rounded-lg px-2 py-1 text-xl font-black w-24 text-amber-400 border-none" oninput="calculateInstantTWD()">
                </div>
            </div>
            <div class="bg-white p-6 shadow-md border-b">
                <div class="space-y-4">
                    <input id="exp-item" type="text" placeholder="消費項目" class="w-full bg-slate-50 rounded-xl px-4 py-3 border-none text-sm font-bold">
                    <div class="flex gap-4">
                        <input id="exp-amount" type="number" placeholder="JPY 金額" class="flex-1 bg-slate-50 rounded-xl px-4 py-3 border-none text-sm font-black" oninput="calculateInstantTWD()">
                        <div class="flex-1 bg-emerald-50 rounded-xl px-4 py-3 text-sm font-black text-emerald-600">NT$ <span id="instant-twd">0</span></div>
                    </div>
                    <div class="flex gap-3">
                        <label class="flex-1 bg-slate-100 p-4 rounded-xl cursor-pointer flex items-center justify-center gap-2 active:bg-slate-200"><i class="fas fa-camera"></i><input type="file" id="exp-photo" accept="image/*" capture="camera" class="hidden" onchange="handleImage(event)"></label>
                        <button onclick="addExpense()" class="flex-[2] bg-indigo-600 text-white py-4 rounded-xl font-black shadow-lg active:scale-95 transition-transform">紀錄此筆</button>
                    </div>
                </div>
            </div>
            <div class="p-4 bg-slate-50 overflow-x-auto min-h-[300px]">
                <table class="w-full text-left bg-white rounded-2xl shadow-sm border text-[11px]">
                    <thead class="bg-slate-50 font-black text-slate-400 uppercase tracking-tighter">
                        <tr><th class="p-3">日期</th><th class="p-3">項目</th><th class="p-3 text-right">JPY</th><th class="p-3 text-right">TWD</th><th class="p-3 text-center">匯率</th><th class="p-3 text-center">收據</th><th class="p-3 text-center">順序</th><th class="p-3 text-center">刪除</th></tr>
                    </thead>
                    <tbody id="expense-list-table"></tbody>
                </table>
            </div>
            <div class="sticky bottom-20 left-0 right-0 p-4 z-30">
                <div class="bg-[#001e43] text-white p-4 rounded-3xl flex justify-between shadow-2xl border border-white/10">
                    <div class="flex-1 border-r border-white/10 pr-4"><p class="text-[8px] font-bold opacity-50 uppercase">Total JPY</p><p class="text-lg font-black text-amber-400">¥ <span id="total-jpy">0</span></p></div>
                    <div class="flex-1 pl-4 text-right"><p class="text-[8px] font-bold opacity-50 uppercase">Total TWD</p><p class="text-lg font-black text-emerald-400">NT$ <span id="total-twd">0</span></p></div>
                </div>
            </div>
        </section>

        <!-- WEATHER -->
        <section id="weather" class="tab-content animate-in p-5">
            <h2 class="text-2xl font-black mb-6 italic px-2">天氣預報</h2>
            <div class="space-y-6">
                <div class="bg-sky-600 rounded-[2.5rem] p-6 text-white shadow-xl relative overflow-hidden"><h4 class="font-black mb-1">福岡市 (Fukuoka)</h4><a href="https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=400000" target="_blank" class="w-full bg-white text-sky-600 py-4 rounded-2xl font-black text-center block mt-4 shadow-lg active:scale-95 transition-transform">詳細預報</a></div>
                <div class="bg-indigo-800 rounded-[2.5rem] p-6 text-white shadow-xl relative overflow-hidden"><h4 class="font-black mb-1">別府 / 大分 (Beppu)</h4><a href="https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=440000" target="_blank" class="w-full bg-white text-indigo-800 py-4 rounded-2xl font-black text-center block mt-4 shadow-lg active:scale-95 transition-transform">詳細預報</a></div>
            </div>
        </section>

        <!-- OTHER -->
        <section id="other" class="tab-content animate-in p-5">
            <h2 class="text-2xl font-black mb-6 italic px-2 flex items-center gap-2"><i class="fas fa-lightbulb text-amber-500"></i> 旅遊建議貼士</h2>
            <div class="space-y-4">
                <div class="tip-card bg-white p-5 rounded-2xl shadow-sm border-l-indigo-900">
                    <div class="font-black text-indigo-900 mb-2 text-sm"><i class="fas fa-car-side"></i> 自駕注意事項 (D2-4)</div>
                    <p class="text-xs text-slate-500 leading-relaxed"><b>ETC：</b> 取車務必確認提供 ETC 卡片，否則無法感應 TEP。<br><b>黑冰：</b> 別府山路 2月清晨注意路面結冰，請謹慎駕駛。</p>
                </div>
                <div class="tip-card bg-white p-5 rounded-2xl shadow-sm border-l-rose-500">
                    <div class="font-black text-rose-600 mb-2 text-sm"><i class="fas fa-utensils"></i> 美食預約</div>
                    <p class="text-xs text-slate-500 leading-relaxed"><b>燒肉：</b> 鍋島與大東園均極熱門，抵日後建議立即預約避免排隊。</p>
                </div>
                <div class="tip-card bg-white p-5 rounded-2xl shadow-sm border-l-emerald-500">
                    <div class="font-black text-emerald-600 mb-2 text-sm"><i class="fas fa-shopping-bag"></i> ON 鞋採購</div>
                    <p class="text-xs text-slate-500 leading-relaxed">建議先查 <b>Sports Depo</b> 官網庫存，避免熱門尺碼缺貨白跑。</p>
                </div>
                <div class="tip-card bg-white p-5 rounded-2xl shadow-sm border-l-pink-400">
                    <div class="font-black text-pink-400 mb-2 text-sm"><i class="fas fa-camera-retro"></i> 太宰府賞梅</div>
                    <p class="text-xs text-slate-500 leading-relaxed">2月下旬高峰人潮多，建議 <b>09:00 前</b> 抵達，拍照品質最佳。</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Nav -->
    <nav class="fixed bottom-0 left-0 right-0 glass-morphism border-t p-4 pb-8 flex justify-around items-center z-50 rounded-t-[2rem] shadow-2xl md:max-w-screen-md md:mx-auto">
        <button onclick="switchTab('plan', this)" class="bottom-nav-item active flex flex-col items-center gap-1"><i class="fas fa-calendar-alt text-lg"></i><span class="text-[9px] font-black uppercase">Plan</span></button>
        <button onclick="switchTab('guide', this)" class="bottom-nav-item flex flex-col items-center gap-1"><i class="fas fa-map-marked-alt text-lg"></i><span class="text-[9px] font-black uppercase">Guide</span></button>
        <button onclick="switchTab('wallet', this)" class="bottom-nav-item flex flex-col items-center gap-1"><i class="fas fa-wallet text-lg"></i><span class="text-[9px] font-black uppercase">Wallet</span></button>
        <button onclick="switchTab('weather', this)" class="bottom-nav-item flex flex-col items-center gap-1"><i class="fas fa-cloud-sun text-lg"></i><span class="text-[9px] font-black uppercase">Weather</span></button>
        <button onclick="switchTab('other', this)" class="bottom-nav-item flex flex-col items-center gap-1"><i class="fas fa-lightbulb text-lg"></i><span class="text-[9px] font-black uppercase">Other</span></button>
    </nav>

    <script>
        // --- 核心資料 ---
        let expenses = JSON.parse(localStorage.getItem('fukuoka_exp_v2')) || [];
        let currentImgBase64 = "";

        const dailyItinerary = {
            1: { title: "D1 | 2/08 福岡抵達", items: [{ name: "福岡機場", note: "19:35 抵達國內航廈 B2" },{ name: "Lawson", note: "領取 TEP" },{ name: "東橫 INN", note: "入住博多西中州" },{ name: "中州屋台", note: "晚餐宵夜" }] },
            2: { title: "D2 | 2/09 啟程自駕", items: [{ name: "AVIS 天神", note: "09:00 取車" },{ name: "由布院", note: "金鱗湖散策" },{ name: "YouMe Town 別府", note: "晚餐購物" },{ name: "龟之井酒店", note: "別府住宿" }] },
            3: { title: "D3 | 2/10 地獄與小倉", items: [{ name: "別府纜車", note: "全景俯瞰" },{ name: "海地獄 九州", note: "溫泉巡禮" },{ name: "鍋島燒肉 九州", note: "熱門午餐" },{ name: "小倉城", note: "古城散策" },{ name: "Korona之湯", note: "泡湯休息" }] },
            4: { title: "D4 | 2/11 門司港浪漫", items: [{ name: "門司港懷舊區", note: "藍翼吊橋" },{ name: "伽哩本舖 門司港", note: "燒咖哩" },{ name: "AVIS 天神", note: "20:00 前還車" },{ name: "大和魯內飯店", note: "入住" }] },
            5: { title: "D5 | 2/12 太宰府賞梅", items: [{ name: "竈門神社 九州", note: "結緣神社" },{ name: "太宰府天滿宮", note: "梅花祭" },{ name: "Sports Depo 太宰府店", note: "買 ON 鞋" },{ name: "八百治博多飯店", note: "泡湯" }] },
            6: { title: "D6 | 2/13 市區採買", items: [{ name: "櫛田神社 福岡", note: "總鎮守" },{ name: "東長寺 福岡", note: "福岡大佛" },{ name: "大東園 祇園亭", note: "燒肉晚餐" },{ name: "Full Full 福岡", note: "明太子麵包" }] },
            7: { title: "D7 | 2/14 歸途準備", items: [{ name: "警固神社 福岡", note: "能量景點" },{ name: "Bic CAMERA 福岡", note: "最後採買" },{ name: "福岡機場 (FUK)", note: "18:30 前報到" }] }
        };

        const guideData = {
            1: { title: "D1 | 中州屋台", spots: [{ name: "中州屋台", desc: "福岡夜晚靈魂，沿河提供拉麵與烤串。" }] },
            2: { title: "D2 | 由布院", spots: [{ name: "由布院", desc: "受歡迎溫泉小鎮，擁有金鱗湖。" }] },
            3: { title: "D3 | 別府與小倉", spots: [{ name: "別府纜車", desc: "俯瞰全景。" },{ name: "地獄溫泉", desc: "海地獄、灶地獄。" },{ name: "小倉城", desc: "具唐造風格歷史古城。" }] },
            4: { title: "D4 | 門司港", spots: [{ name: "門司港懷舊區", desc: "保存許多大正時期西洋風格建築。" },{ name: "藍翼門司吊橋", desc: "日本唯一的步行者專用開合橋。" }] },
            5: { title: "D5 | 太宰府", spots: [{ name: "竈門神社", desc: "現代風格結緣聖地。" },{ name: "太宰府天滿宮", desc: "祭祀學問之神，2月賞梅首選。" }] },
            6: { title: "D6 | 博多信仰", spots: [{ name: "櫛田神社", desc: "博多總鎮守，山笠祭舞台。" },{ name: "東長寺", desc: "擁有巨大木造大佛。" }] },
            7: { title: "D7 | 警固平安", spots: [{ name: "警固神社", desc: "鬧區中的靜謐能量景點。" }] }
        };

        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.bottom-nav-item').forEach(b => b.classList.remove('active'));
            el.classList.add('active'); window.scrollTo(0, 0);
        }

        function switchDay(n) {
            document.querySelectorAll('.day-tab').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById(`day-btn-${n}`);
            if (btn) btn.classList.add('active');
            const d = dailyItinerary[n];
            document.getElementById('day-content').innerHTML = `
                <h4 class="font-black text-slate-800 text-sm border-b-2 border-amber-400 pb-2 mb-4">${d.title}</h4>
                <div class="space-y-4">
                    ${d.items.map(i => `
                        <div class="flex items-start gap-3">
                            <div class="w-1.5 h-1.5 bg-indigo-900 rounded-full mt-1.5"></div>
                            <div class="flex-1">
                                <div class="flex justify-between items-start">
                                    <p class="text-xs font-black text-slate-700">${i.name}</p>
                                    <button onclick="openMap('${i.name}')" class="text-[10px] bg-slate-100 px-2 py-1 rounded-md text-slate-500 font-bold"><i class="fas fa-location-arrow"></i></button>
                                </div>
                                <p class="text-[10px] text-slate-400 mt-1">${i.note}</p>
                            </div>
                        </div>`).join('')}
                </div>`;
        }

        function switchGuideDay(n) {
            document.querySelectorAll('.guide-day-tab').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById(`guide-day-btn-${n}`);
            if (btn) btn.classList.add('active');
            const d = guideData[n];
            document.getElementById('guide-content').innerHTML = `
                <h4 class="font-black text-indigo-900 text-sm border-b-2 border-indigo-200 pb-2 mb-4">${d.title}</h4>
                <div class="space-y-6">
                    ${d.spots.map(s => `
                        <div>
                            <div class="flex justify-between items-center mb-1"><h5 class="font-black text-xs"># ${s.name}</h5><button onclick="openSearch('${s.name}')" class="text-[9px] bg-rose-50 px-2 py-1 rounded text-rose-500 italic font-bold">搜尋</button></div>
                            <p class="text-[10px] text-slate-500 leading-relaxed bg-slate-50 p-3 rounded-xl">${s.desc}</p>
                        </div>`).join('')}
                </div>`;
        }

        function openMap(q) { const o = q.includes('九州') || q.includes('福岡') ? q : q + ' 九州'; window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(o)}`, '_blank'); }
        function openSearch(q) { window.open(`https://www.google.com/search?q=${encodeURIComponent(q + ' 景點 介紹')}`, '_blank'); }
        function calculateInstantTWD() { const r = parseFloat(document.getElementById('rate-input').value) || 0; const a = parseFloat(document.getElementById('exp-amount').value) || 0; const res = Math.round(a * r); document.getElementById('instant-twd').innerText = res.toLocaleString(); return res; }
        function handleImage(e) { const f = e.target.files[0]; if (!f) return; const rd = new FileReader(); rd.onload = function(ev) { const i = new Image(); i.onload = function() { const c = document.createElement('canvas'); const ctx = c.getContext('2d'); c.width = 150; c.height = i.height * (150/i.width); ctx.drawImage(i, 0,0,150,c.height); currentImgBase64 = c.toDataURL('image/jpeg', 0.6); }; i.src = ev.target.result; }; rd.readAsDataURL(f); }
        function addExpense() { const it = document.getElementById('exp-item').value, am = parseFloat(document.getElementById('exp-amount').value) || 0, ra = parseFloat(document.getElementById('rate-input').value) || 0; if(!it || !am) return alert("請輸入資訊"); expenses.unshift({id: Date.now(), date: new Date().toLocaleDateString('zh-TW', {month:'2-digit', day:'2-digit'}), name: it, jpy: am, twd: Math.round(am*ra), rateUsed: ra, img: currentImgBase64}); localStorage.setItem('fukuoka_exp_v2', JSON.stringify(expenses)); renderExpenses(); document.getElementById('exp-item').value=""; document.getElementById('exp-amount').value=""; document.getElementById('instant-twd').innerText="0"; currentImgBase64=""; }
        function moveExpense(idx, dir) { const n = idx+dir; if(n>=0 && n<expenses.length){ const t = expenses[idx]; expenses[idx]=expenses[n]; expenses[n]=t; localStorage.setItem('fukuoka_exp_v2', JSON.stringify(expenses)); renderExpenses(); } }
        function deleteExpense(id) { expenses = expenses.filter(e => e.id !== id); localStorage.setItem('fukuoka_exp_v2', JSON.stringify(expenses)); renderExpenses(); }
        function renderExpenses() { 
            const tb = document.getElementById('expense-list-table'); let tj = 0, tt = 0; if(!tb) return;
            tb.innerHTML = expenses.map((e, i) => { tj += e.jpy; tt += e.twd; return `
                <tr class="border-b text-[11px]"><td class="p-3">${e.date}</td><td class="p-3 font-bold">${e.name}</td><td class="p-3 text-right">¥${e.jpy.toLocaleString()}</td><td class="p-3 text-right font-black text-emerald-600">NT$${e.twd.toLocaleString()}</td><td class="p-3 text-center">${e.rateUsed}</td><td class="p-3 text-center">${e.img ? `<img src="${e.img}" class="w-8 h-8 rounded mx-auto object-cover border">` : '-'}</td><td class="p-3 text-center"><div class="flex flex-col gap-1"><button onclick="moveExpense(${i},-1)" class="order-btn">▲</button><button onclick="moveExpense(${i},1)" class="order-btn">▼</button></div></td><td class="p-3 text-center"><button onclick="deleteExpense(${e.id})" class="text-rose-400 p-2"><i class="fas fa-trash-alt"></i></button></td></tr>`;
            }).join(''); document.getElementById('total-jpy').innerText = tj.toLocaleString(); document.getElementById('total-twd').innerText = tt.toLocaleString();
        }
        window.onload = () => { switchDay(1); switchGuideDay(1); renderExpenses(); };
    </script>
</body>
</html>
